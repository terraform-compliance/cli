{"format_version":"0.1","terraform_version":"0.15.5","planned_values":{"root_module":{"child_modules":[{"resources":[{"address":"module.apigw_test_1.aws_api_gateway_account.main","mode":"managed","type":"aws_api_gateway_account","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0},{"address":"module.apigw_test_1.aws_api_gateway_base_path_mapping.main","mode":"managed","type":"aws_api_gateway_base_path_mapping","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"base_path":null,"domain_name":"testapi.cc.aws.cmclabs.io","stage_name":"main"}},{"address":"module.apigw_test_1.aws_api_gateway_deployment.main","mode":"managed","type":"aws_api_gateway_deployment","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"stage_description":null,"stage_name":null,"triggers":null,"variables":null}},{"address":"module.apigw_test_1.aws_api_gateway_domain_name.apigw","mode":"managed","type":"aws_api_gateway_domain_name","name":"apigw","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"certificate_arn":null,"certificate_body":null,"certificate_chain":null,"certificate_name":null,"certificate_private_key":null,"domain_name":"testapi.cc.aws.cmclabs.io","endpoint_configuration":[{"types":["REGIONAL"]}],"mutual_tls_authentication":[],"regional_certificate_name":null,"security_policy":"TLS_1_2","tags":null}},{"address":"module.apigw_test_1.aws_api_gateway_integration.root_integration","mode":"managed","type":"aws_api_gateway_integration","name":"root_integration","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"cache_key_parameters":null,"connection_id":null,"connection_type":"INTERNET","content_handling":null,"credentials":null,"http_method":"ANY","integration_http_method":null,"passthrough_behavior":"WHEN_NO_TEMPLATES","request_parameters":null,"request_templates":{"application/json":"{\"statusCode\": 200}\n"},"timeout_milliseconds":29000,"tls_config":[],"type":"MOCK","uri":null}},{"address":"module.apigw_test_1.aws_api_gateway_integration_response.root_integration_response","mode":"managed","type":"aws_api_gateway_integration_response","name":"root_integration_response","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"content_handling":null,"http_method":"ANY","response_parameters":null,"response_templates":{"application/json":"{\"ok\": true}"},"selection_pattern":null,"status_code":"200"}},{"address":"module.apigw_test_1.aws_api_gateway_method.root_method","mode":"managed","type":"aws_api_gateway_method","name":"root_method","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"api_key_required":false,"authorization":"NONE","authorization_scopes":null,"authorizer_id":null,"http_method":"ANY","operation_name":null,"request_models":null,"request_parameters":null,"request_validator_id":null}},{"address":"module.apigw_test_1.aws_api_gateway_method_response.root_response","mode":"managed","type":"aws_api_gateway_method_response","name":"root_response","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"http_method":"ANY","response_models":{"application/json":"Empty"},"response_parameters":null,"status_code":"200"}},{"address":"module.apigw_test_1.aws_api_gateway_method_settings.main","mode":"managed","type":"aws_api_gateway_method_settings","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"method_path":"*/*","settings":[{"data_trace_enabled":false,"logging_level":"INFO","metrics_enabled":true,"throttling_burst_limit":-1,"throttling_rate_limit":-1}],"stage_name":"main"}},{"address":"module.apigw_test_1.aws_api_gateway_rest_api.base","mode":"managed","type":"aws_api_gateway_rest_api","name":"base","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"body":null,"endpoint_configuration":[{"types":["REGIONAL"]}],"minimum_compression_size":-1,"name":"cc-testapi","parameters":null,"tags":null}},{"address":"module.apigw_test_1.aws_api_gateway_stage.main","mode":"managed","type":"aws_api_gateway_stage","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"access_log_settings":[{"destination_arn":"arn:aws:firehose:eu-west-1:740863752284:deliverystream/amazon-apigateway-logs-firehose","format":"$context.accountId,$context.identity.sourceIp,$context.identity.caller,$context.identity.user,$context.requestTime,$context.httpMethod,$context.resourcePath,$context.protocol,$context.status,$context.responseLength,$context.requestId"}],"cache_cluster_enabled":false,"cache_cluster_size":"0.5","client_certificate_id":null,"description":null,"documentation_version":null,"stage_name":"main","tags":null,"variables":null,"xray_tracing_enabled":false}},{"address":"module.apigw_test_1.aws_route53_record.apigw","mode":"managed","type":"aws_route53_record","name":"apigw","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"alias":[{"evaluate_target_health":true}],"failover_routing_policy":[],"geolocation_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"name":"testapi.cc.aws.cmclabs.io","records":null,"set_identifier":null,"ttl":null,"type":"A","weighted_routing_policy":[],"zone_id":"Z001064436264QN0EN6ZC"}},{"address":"module.apigw_test_1.aws_ssm_parameter.api_gw_arn","mode":"managed","type":"aws_ssm_parameter","name":"api_gw_arn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"allowed_pattern":null,"description":null,"name":"/cc/api_gw/testapi/arn","overwrite":null,"tags":null,"tier":"Standard","type":"String"}},{"address":"module.apigw_test_1.aws_ssm_parameter.api_gw_id","mode":"managed","type":"aws_ssm_parameter","name":"api_gw_id","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"allowed_pattern":null,"description":null,"name":"/cc/api_gw/testapi/id","overwrite":null,"tags":null,"tier":"Standard","type":"String"}},{"address":"module.apigw_test_1.aws_ssm_parameter.api_gw_name","mode":"managed","type":"aws_ssm_parameter","name":"api_gw_name","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"allowed_pattern":null,"description":null,"name":"/cc/api_gw/testapi/name","overwrite":null,"tags":null,"tier":"Standard","type":"String","value":"cc-testapi"}},{"address":"module.apigw_test_1.aws_ssm_parameter.api_gw_root_resource_id","mode":"managed","type":"aws_ssm_parameter","name":"api_gw_root_resource_id","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"allowed_pattern":null,"description":null,"name":"/cc/api_gw/testapi/root_resource_id","overwrite":null,"tags":null,"tier":"Standard","type":"String"}},{"address":"module.apigw_test_1.aws_wafv2_web_acl_association.main","mode":"managed","type":"aws_wafv2_web_acl_association","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"web_acl_arn":"arn:aws:wafv2:eu-west-1:123456789101:regional/webacl/test/728c885d-b323-4290-80fb-5ef062917742"}}],"address":"module.apigw_test_1","child_modules":[{"resources":[{"address":"module.apigw_test_1.module.api_gw_log_role.aws_iam_policy.default[0]","mode":"managed","type":"aws_iam_policy","name":"default","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"name":"cc-testapi-logs-eu-west-1","name_prefix":null,"path":"/","policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:PutLogEvents\",\n        \"logs:GetLogEvents\",\n        \"logs:FilterLogEvents\",\n        \"logs:DescribeLogStreams\",\n        \"logs:DescribeLogGroups\",\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}","tags":null}},{"address":"module.apigw_test_1.module.api_gw_log_role.aws_iam_role.default","mode":"managed","type":"aws_iam_role","name":"default","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sts:TagSession\",\n        \"sts:AssumeRole\"\n      ],\n      \"Principal\": {\n        \"Service\": \"apigateway.amazonaws.com\"\n      }\n    }\n  ]\n}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"cc-testapi-logs-eu-west-1","name_prefix":null,"path":"/","permissions_boundary":"arn:aws:iam::123456789101:policy/product-pb","tags":{"product":"cc"},"tags_all":{"product":"cc"}}},{"address":"module.apigw_test_1.module.api_gw_log_role.aws_iam_role_policy_attachment.inline[0]","mode":"managed","type":"aws_iam_role_policy_attachment","name":"inline","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"role":"cc-testapi-logs-eu-west-1"}}],"address":"module.apigw_test_1.module.api_gw_log_role"},{"resources":[{"address":"module.apigw_test_1.module.acm_cert_regional[0].aws_acm_certificate.cert","mode":"managed","type":"aws_acm_certificate","name":"cert","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"certificate_authority_arn":null,"certificate_body":null,"certificate_chain":null,"domain_name":"testapi.cc.aws.cmclabs.io","domain_validation_options":[{"domain_name":"testapi.cc.aws.cmclabs.io"}],"options":[],"private_key":null,"tags":{"product":"cc"},"tags_all":{"product":"cc"},"validation_method":"DNS"}},{"address":"module.apigw_test_1.module.acm_cert_regional[0].aws_acm_certificate_validation.cert_validation","mode":"managed","type":"aws_acm_certificate_validation","name":"cert_validation","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"timeouts":null}},{"address":"module.apigw_test_1.module.acm_cert_regional[0].aws_route53_record.cert_validation[\"testapi.cc.aws.cmclabs.io\"]","mode":"managed","type":"aws_route53_record","name":"cert_validation","index":"testapi.cc.aws.cmclabs.io","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"alias":[],"allow_overwrite":true,"failover_routing_policy":[],"geolocation_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"set_identifier":null,"ttl":60,"weighted_routing_policy":[],"zone_id":"Z001064436264QN0EN6ZC"}}],"address":"module.apigw_test_1.module.acm_cert_regional[0]"}]}]}},"resource_changes":[{"address":"module.apigw_test_1.aws_api_gateway_account.main","module_address":"module.apigw_test_1","mode":"managed","type":"aws_api_gateway_account","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{},"after_unknown":{"cloudwatch_role_arn":true,"id":true,"throttle_settings":true},"before_sensitive":false,"after_sensitive":{"throttle_settings":[]}}},{"address":"module.apigw_test_1.aws_api_gateway_base_path_mapping.main","module_address":"module.apigw_test_1","mode":"managed","type":"aws_api_gateway_base_path_mapping","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"base_path":null,"domain_name":"testapi.cc.aws.cmclabs.io","stage_name":"main"},"after_unknown":{"api_id":true,"id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.apigw_test_1.aws_api_gateway_deployment.main","module_address":"module.apigw_test_1","mode":"managed","type":"aws_api_gateway_deployment","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"stage_description":null,"stage_name":null,"triggers":null,"variables":null},"after_unknown":{"created_date":true,"execution_arn":true,"id":true,"invoke_url":true,"rest_api_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.apigw_test_1.aws_api_gateway_domain_name.apigw","module_address":"module.apigw_test_1","mode":"managed","type":"aws_api_gateway_domain_name","name":"apigw","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"certificate_arn":null,"certificate_body":null,"certificate_chain":null,"certificate_name":null,"certificate_private_key":null,"domain_name":"testapi.cc.aws.cmclabs.io","endpoint_configuration":[{"types":["REGIONAL"]}],"mutual_tls_authentication":[],"regional_certificate_name":null,"security_policy":"TLS_1_2","tags":null},"after_unknown":{"arn":true,"certificate_upload_date":true,"cloudfront_domain_name":true,"cloudfront_zone_id":true,"endpoint_configuration":[{"types":[false]}],"id":true,"mutual_tls_authentication":[],"regional_certificate_arn":true,"regional_domain_name":true,"regional_zone_id":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"certificate_private_key":true,"endpoint_configuration":[{"types":[false]}],"mutual_tls_authentication":[],"regional_certificate_arn":true,"tags_all":{}}}},{"address":"module.apigw_test_1.aws_api_gateway_integration.root_integration","module_address":"module.apigw_test_1","mode":"managed","type":"aws_api_gateway_integration","name":"root_integration","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cache_key_parameters":null,"connection_id":null,"connection_type":"INTERNET","content_handling":null,"credentials":null,"http_method":"ANY","integration_http_method":null,"passthrough_behavior":"WHEN_NO_TEMPLATES","request_parameters":null,"request_templates":{"application/json":"{\"statusCode\": 200}\n"},"timeout_milliseconds":29000,"tls_config":[],"type":"MOCK","uri":null},"after_unknown":{"cache_namespace":true,"id":true,"request_templates":{},"resource_id":true,"rest_api_id":true,"tls_config":[]},"before_sensitive":false,"after_sensitive":{"request_templates":{},"tls_config":[]}}},{"address":"module.apigw_test_1.aws_api_gateway_integration_response.root_integration_response","module_address":"module.apigw_test_1","mode":"managed","type":"aws_api_gateway_integration_response","name":"root_integration_response","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"content_handling":null,"http_method":"ANY","response_parameters":null,"response_templates":{"application/json":"{\"ok\": true}"},"selection_pattern":null,"status_code":"200"},"after_unknown":{"id":true,"resource_id":true,"response_templates":{},"rest_api_id":true},"before_sensitive":false,"after_sensitive":{"response_templates":{}}}},{"address":"module.apigw_test_1.aws_api_gateway_method.root_method","module_address":"module.apigw_test_1","mode":"managed","type":"aws_api_gateway_method","name":"root_method","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"api_key_required":false,"authorization":"NONE","authorization_scopes":null,"authorizer_id":null,"http_method":"ANY","operation_name":null,"request_models":null,"request_parameters":null,"request_validator_id":null},"after_unknown":{"id":true,"resource_id":true,"rest_api_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.apigw_test_1.aws_api_gateway_method_response.root_response","module_address":"module.apigw_test_1","mode":"managed","type":"aws_api_gateway_method_response","name":"root_response","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"http_method":"ANY","response_models":{"application/json":"Empty"},"response_parameters":null,"status_code":"200"},"after_unknown":{"id":true,"resource_id":true,"response_models":{},"rest_api_id":true},"before_sensitive":false,"after_sensitive":{"response_models":{}}}},{"address":"module.apigw_test_1.aws_api_gateway_method_settings.main","module_address":"module.apigw_test_1","mode":"managed","type":"aws_api_gateway_method_settings","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"method_path":"*/*","settings":[{"data_trace_enabled":false,"logging_level":"INFO","metrics_enabled":true,"throttling_burst_limit":-1,"throttling_rate_limit":-1}],"stage_name":"main"},"after_unknown":{"id":true,"rest_api_id":true,"settings":[{"cache_data_encrypted":true,"cache_ttl_in_seconds":true,"caching_enabled":true,"require_authorization_for_cache_control":true,"unauthorized_cache_control_header_strategy":true}]},"before_sensitive":false,"after_sensitive":{"settings":[{}]}}},{"address":"module.apigw_test_1.aws_api_gateway_rest_api.base","module_address":"module.apigw_test_1","mode":"managed","type":"aws_api_gateway_rest_api","name":"base","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"body":null,"endpoint_configuration":[{"types":["REGIONAL"]}],"minimum_compression_size":-1,"name":"cc-testapi","parameters":null,"tags":null},"after_unknown":{"api_key_source":true,"arn":true,"binary_media_types":true,"created_date":true,"description":true,"disable_execute_api_endpoint":true,"endpoint_configuration":[{"types":[false],"vpc_endpoint_ids":true}],"execution_arn":true,"id":true,"policy":true,"root_resource_id":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"binary_media_types":[],"endpoint_configuration":[{"types":[false],"vpc_endpoint_ids":[]}],"tags_all":{}}}},{"address":"module.apigw_test_1.aws_api_gateway_stage.main","module_address":"module.apigw_test_1","mode":"managed","type":"aws_api_gateway_stage","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"access_log_settings":[{"destination_arn":"arn:aws:firehose:eu-west-1:740863752284:deliverystream/amazon-apigateway-logs-firehose","format":"$context.accountId,$context.identity.sourceIp,$context.identity.caller,$context.identity.user,$context.requestTime,$context.httpMethod,$context.resourcePath,$context.protocol,$context.status,$context.responseLength,$context.requestId"}],"cache_cluster_enabled":false,"cache_cluster_size":"0.5","client_certificate_id":null,"description":null,"documentation_version":null,"stage_name":"main","tags":null,"variables":null,"xray_tracing_enabled":false},"after_unknown":{"access_log_settings":[{}],"arn":true,"deployment_id":true,"execution_arn":true,"id":true,"invoke_url":true,"rest_api_id":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"access_log_settings":[{"destination_arn":true}],"tags_all":{}}}},{"address":"module.apigw_test_1.aws_route53_record.apigw","module_address":"module.apigw_test_1","mode":"managed","type":"aws_route53_record","name":"apigw","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alias":[{"evaluate_target_health":true}],"failover_routing_policy":[],"geolocation_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"name":"testapi.cc.aws.cmclabs.io","records":null,"set_identifier":null,"ttl":null,"type":"A","weighted_routing_policy":[],"zone_id":"Z001064436264QN0EN6ZC"},"after_unknown":{"alias":[{"name":true,"zone_id":true}],"allow_overwrite":true,"failover_routing_policy":[],"fqdn":true,"geolocation_routing_policy":[],"id":true,"latency_routing_policy":[],"weighted_routing_policy":[]},"before_sensitive":false,"after_sensitive":{"alias":[{}],"failover_routing_policy":[],"geolocation_routing_policy":[],"latency_routing_policy":[],"weighted_routing_policy":[]}}},{"address":"module.apigw_test_1.aws_ssm_parameter.api_gw_arn","module_address":"module.apigw_test_1","mode":"managed","type":"aws_ssm_parameter","name":"api_gw_arn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"allowed_pattern":null,"description":null,"name":"/cc/api_gw/testapi/arn","overwrite":null,"tags":null,"tier":"Standard","type":"String"},"after_unknown":{"arn":true,"data_type":true,"id":true,"key_id":true,"tags_all":true,"value":true,"version":true},"before_sensitive":false,"after_sensitive":{"tags_all":{},"value":true}}},{"address":"module.apigw_test_1.aws_ssm_parameter.api_gw_id","module_address":"module.apigw_test_1","mode":"managed","type":"aws_ssm_parameter","name":"api_gw_id","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"allowed_pattern":null,"description":null,"name":"/cc/api_gw/testapi/id","overwrite":null,"tags":null,"tier":"Standard","type":"String"},"after_unknown":{"arn":true,"data_type":true,"id":true,"key_id":true,"tags_all":true,"value":true,"version":true},"before_sensitive":false,"after_sensitive":{"tags_all":{},"value":true}}},{"address":"module.apigw_test_1.aws_ssm_parameter.api_gw_name","module_address":"module.apigw_test_1","mode":"managed","type":"aws_ssm_parameter","name":"api_gw_name","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"allowed_pattern":null,"description":null,"name":"/cc/api_gw/testapi/name","overwrite":null,"tags":null,"tier":"Standard","type":"String","value":"cc-testapi"},"after_unknown":{"arn":true,"data_type":true,"id":true,"key_id":true,"tags_all":true,"version":true},"before_sensitive":false,"after_sensitive":{"tags_all":{},"value":true}}},{"address":"module.apigw_test_1.aws_ssm_parameter.api_gw_root_resource_id","module_address":"module.apigw_test_1","mode":"managed","type":"aws_ssm_parameter","name":"api_gw_root_resource_id","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"allowed_pattern":null,"description":null,"name":"/cc/api_gw/testapi/root_resource_id","overwrite":null,"tags":null,"tier":"Standard","type":"String"},"after_unknown":{"arn":true,"data_type":true,"id":true,"key_id":true,"tags_all":true,"value":true,"version":true},"before_sensitive":false,"after_sensitive":{"tags_all":{},"value":true}}},{"address":"module.apigw_test_1.aws_wafv2_web_acl_association.main","module_address":"module.apigw_test_1","mode":"managed","type":"aws_wafv2_web_acl_association","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"web_acl_arn":"arn:aws:wafv2:eu-west-1:123456789101:regional/webacl/test/728c885d-b323-4290-80fb-5ef062917742"},"after_unknown":{"id":true,"resource_arn":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.apigw_test_1.module.acm_cert_regional[0].aws_acm_certificate.cert","module_address":"module.apigw_test_1.module.acm_cert_regional[0]","mode":"managed","type":"aws_acm_certificate","name":"cert","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"certificate_authority_arn":null,"certificate_body":null,"certificate_chain":null,"domain_name":"testapi.cc.aws.cmclabs.io","domain_validation_options":[{"domain_name":"testapi.cc.aws.cmclabs.io"}],"options":[],"private_key":null,"tags":{"product":"cc"},"tags_all":{"product":"cc"},"validation_method":"DNS"},"after_unknown":{"arn":true,"domain_validation_options":[{"resource_record_name":true,"resource_record_type":true,"resource_record_value":true}],"id":true,"options":[],"status":true,"subject_alternative_names":true,"tags":{},"tags_all":{},"validation_emails":true},"before_sensitive":false,"after_sensitive":{"domain_validation_options":[{}],"options":[],"private_key":true,"subject_alternative_names":[],"tags":{},"tags_all":{},"validation_emails":[]}}},{"address":"module.apigw_test_1.module.acm_cert_regional[0].aws_acm_certificate_validation.cert_validation","module_address":"module.apigw_test_1.module.acm_cert_regional[0]","mode":"managed","type":"aws_acm_certificate_validation","name":"cert_validation","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"timeouts":null},"after_unknown":{"certificate_arn":true,"id":true,"validation_record_fqdns":true},"before_sensitive":false,"after_sensitive":{"validation_record_fqdns":[]}}},{"address":"module.apigw_test_1.module.acm_cert_regional[0].aws_route53_record.cert_validation[\"testapi.cc.aws.cmclabs.io\"]","module_address":"module.apigw_test_1.module.acm_cert_regional[0]","mode":"managed","type":"aws_route53_record","name":"cert_validation","index":"testapi.cc.aws.cmclabs.io","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alias":[],"allow_overwrite":true,"failover_routing_policy":[],"geolocation_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"set_identifier":null,"ttl":60,"weighted_routing_policy":[],"zone_id":"Z001064436264QN0EN6ZC"},"after_unknown":{"alias":[],"failover_routing_policy":[],"fqdn":true,"geolocation_routing_policy":[],"id":true,"latency_routing_policy":[],"name":true,"records":true,"type":true,"weighted_routing_policy":[]},"before_sensitive":false,"after_sensitive":{"alias":[],"failover_routing_policy":[],"geolocation_routing_policy":[],"latency_routing_policy":[],"records":[],"weighted_routing_policy":[]}}},{"address":"module.apigw_test_1.module.api_gw_log_role.aws_iam_policy.default[0]","module_address":"module.apigw_test_1.module.api_gw_log_role","mode":"managed","type":"aws_iam_policy","name":"default","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"name":"cc-testapi-logs-eu-west-1","name_prefix":null,"path":"/","policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:PutLogEvents\",\n        \"logs:GetLogEvents\",\n        \"logs:FilterLogEvents\",\n        \"logs:DescribeLogStreams\",\n        \"logs:DescribeLogGroups\",\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}","tags":null},"after_unknown":{"arn":true,"id":true,"policy_id":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"tags_all":{}}}},{"address":"module.apigw_test_1.module.api_gw_log_role.aws_iam_role.default","module_address":"module.apigw_test_1.module.api_gw_log_role","mode":"managed","type":"aws_iam_role","name":"default","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sts:TagSession\",\n        \"sts:AssumeRole\"\n      ],\n      \"Principal\": {\n        \"Service\": \"apigateway.amazonaws.com\"\n      }\n    }\n  ]\n}","description":null,"force_detach_policies":false,"max_session_duration":3600,"name":"cc-testapi-logs-eu-west-1","name_prefix":null,"path":"/","permissions_boundary":"arn:aws:iam::123456789101:policy/product-pb","tags":{"product":"cc"},"tags_all":{"product":"cc"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":true,"managed_policy_arns":true,"tags":{},"tags_all":{},"unique_id":true},"before_sensitive":false,"after_sensitive":{"inline_policy":[],"managed_policy_arns":[],"tags":{},"tags_all":{}}}},{"address":"module.apigw_test_1.module.api_gw_log_role.aws_iam_role_policy_attachment.inline[0]","module_address":"module.apigw_test_1.module.api_gw_log_role","mode":"managed","type":"aws_iam_role_policy_attachment","name":"inline","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"role":"cc-testapi-logs-eu-west-1"},"after_unknown":{"id":true,"policy_arn":true},"before_sensitive":false,"after_sensitive":{}}}],"prior_state":{"format_version":"0.1","terraform_version":"0.15.5","values":{"root_module":{"child_modules":[{"resources":[{"address":"module.apigw_test_1.data.aws_iam_policy_document.api_gw_logs","mode":"data","type":"aws_iam_policy_document","name":"api_gw_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"4090776918","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:PutLogEvents\",\n        \"logs:GetLogEvents\",\n        \"logs:FilterLogEvents\",\n        \"logs:DescribeLogStreams\",\n        \"logs:DescribeLogGroups\",\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["logs:CreateLogGroup","logs:CreateLogStream","logs:DescribeLogGroups","logs:DescribeLogStreams","logs:FilterLogEvents","logs:GetLogEvents","logs:PutLogEvents"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[],"resources":["*"],"sid":""}],"version":"2012-10-17"}},{"address":"module.apigw_test_1.data.aws_region.current","mode":"data","type":"aws_region","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Europe (Ireland)","endpoint":"ec2.eu-west-1.amazonaws.com","id":"eu-west-1","name":"eu-west-1"}},{"address":"module.apigw_test_1.data.aws_route53_zone.main","mode":"data","type":"aws_route53_zone","name":"main","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:route53:::hostedzone/Z001064436264QN0EN6ZC","caller_reference":"terraform-20210204130618818300000001","comment":"Domain Delegation for cc.aws.cmclabs.io","id":"Z001064436264QN0EN6ZC","linked_service_description":null,"linked_service_principal":null,"name":"cc.aws.cmclabs.io","name_servers":["ns-1969.awsdns-54.co.uk","ns-96.awsdns-12.com","ns-871.awsdns-44.net","ns-1047.awsdns-02.org"],"private_zone":false,"resource_record_set_count":9,"tags":{"product":"cc"},"vpc_id":null,"zone_id":"Z001064436264QN0EN6ZC"}},{"address":"module.apigw_test_1.data.aws_ssm_parameter.stream_arn","mode":"data","type":"aws_ssm_parameter","name":"stream_arn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:ssm:eu-west-1:740863752284:parameter/cc/account/logging/delivery_streams/apigateway/arn","id":"/cc/account/logging/delivery_streams/apigateway/arn","name":"/cc/account/logging/delivery_streams/apigateway/arn","type":"String","value":"arn:aws:firehose:eu-west-1:740863752284:deliverystream/amazon-apigateway-logs-firehose","version":1,"with_decryption":true}}],"address":"module.apigw_test_1","child_modules":[{"resources":[{"address":"module.apigw_test_1.module.acm_cert_regional[0].data.aws_route53_zone.external","mode":"data","type":"aws_route53_zone","name":"external","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:route53:::hostedzone/Z001064436264QN0EN6ZC","caller_reference":"terraform-20210204130618818300000001","comment":"Domain Delegation for cc.aws.cmclabs.io","id":"Z001064436264QN0EN6ZC","linked_service_description":null,"linked_service_principal":null,"name":"cc.aws.cmclabs.io","name_servers":["ns-1969.awsdns-54.co.uk","ns-96.awsdns-12.com","ns-871.awsdns-44.net","ns-1047.awsdns-02.org"],"private_zone":false,"resource_record_set_count":9,"tags":{"product":"cc"},"vpc_id":null,"zone_id":"Z001064436264QN0EN6ZC"}}],"address":"module.apigw_test_1.module.acm_cert_regional[0]","child_modules":[{"resources":[{"address":"module.apigw_test_1.module.acm_cert_regional[0].module.common.data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"account_id":"740863752284","arn":"arn:aws:sts::740863752284:assumed-role/cc-pipeline_ci/GitHubActions","id":"740863752284","user_id":"AROA2Y7XLXBONTJPUYSTI:GitHubActions"}}],"address":"module.apigw_test_1.module.acm_cert_regional[0].module.common"}]},{"resources":[{"address":"module.apigw_test_1.module.api_gw_log_role.data.aws_iam_policy_document.assume_role_policy","mode":"data","type":"aws_iam_policy_document","name":"assume_role_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"948448419","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sts:TagSession\",\n        \"sts:AssumeRole\"\n      ],\n      \"Principal\": {\n        \"Service\": \"apigateway.amazonaws.com\"\n      }\n    }\n  ]\n}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole","sts:TagSession"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["apigateway.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"}}],"address":"module.apigw_test_1.module.api_gw_log_role","child_modules":[{"resources":[{"address":"module.apigw_test_1.module.api_gw_log_role.module.common.data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"account_id":"740863752284","arn":"arn:aws:sts::740863752284:assumed-role/cc-pipeline_ci/GitHubActions","id":"740863752284","user_id":"AROA2Y7XLXBONTJPUYSTI:GitHubActions"}}],"address":"module.apigw_test_1.module.api_gw_log_role.module.common"}]}]}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","expressions":{"region":{"constant_value":"eu-west-1"}}},"aws.useast1":{"name":"aws","alias":"useast1","expressions":{"region":{"constant_value":"us-east-1"}}},"module.apigw_test_1:aws":{"name":"aws","version_constraint":"\u003e= 3.8.0","module_address":"module.apigw_test_1"},"module.apigw_test_1:aws.edgeprovider":{"name":"aws","alias":"edgeprovider","version_constraint":"\u003e= 3.8.0","module_address":"module.apigw_test_1"}},"root_module":{"module_calls":{"apigw_test_1":{"source":"git::ssh://git@github.com/cmctechnology/cc-tf-modules.git//aws-apigw-rest?ref=15.0.3","expressions":{"api_name":{"constant_value":"testapi"},"domain_hosted_zone":{"constant_value":"cc.aws.cmclabs.io"},"endpoint_type":{"constant_value":"REGIONAL"},"permissions_boundary":{"constant_value":"arn:aws:iam::123456789101:policy/product-pb"},"product":{"constant_value":"cc"},"waf_arn":{"constant_value":"arn:aws:wafv2:eu-west-1:123456789101:regional/webacl/test/728c885d-b323-4290-80fb-5ef062917742"}},"module":{"outputs":{"api_gateway":{"expression":{"references":["aws_api_gateway_rest_api.base"]}}},"resources":[{"address":"aws_api_gateway_account.main","mode":"managed","type":"aws_api_gateway_account","name":"main","provider_config_key":"apigw_test_1:aws","expressions":{"cloudwatch_role_arn":{"references":["module.api_gw_log_role.role"]}},"schema_version":0},{"address":"aws_api_gateway_base_path_mapping.main","mode":"managed","type":"aws_api_gateway_base_path_mapping","name":"main","provider_config_key":"apigw_test_1:aws","expressions":{"api_id":{"references":["aws_api_gateway_rest_api.base"]},"domain_name":{"references":["aws_api_gateway_domain_name.apigw"]},"stage_name":{"references":["aws_api_gateway_stage.main"]}},"schema_version":0},{"address":"aws_api_gateway_deployment.main","mode":"managed","type":"aws_api_gateway_deployment","name":"main","provider_config_key":"apigw_test_1:aws","expressions":{"rest_api_id":{"references":["aws_api_gateway_rest_api.base"]}},"schema_version":0,"depends_on":["aws_api_gateway_method_response.root_response"]},{"address":"aws_api_gateway_domain_name.apigw","mode":"managed","type":"aws_api_gateway_domain_name","name":"apigw","provider_config_key":"apigw_test_1:aws","expressions":{"certificate_arn":{"references":["var.endpoint_type","module.acm_cert_edge[0].cert"]},"domain_name":{"references":["var.api_name","data.aws_route53_zone.main"]},"endpoint_configuration":[{"types":{"references":["var.endpoint_type"]}}],"regional_certificate_arn":{"references":["var.endpoint_type","module.acm_cert_regional[0].cert"]},"security_policy":{"constant_value":"TLS_1_2"}},"schema_version":0,"depends_on":["module.acm_cert_edge","module.acm_cert_regional"]},{"address":"aws_api_gateway_integration.root_integration","mode":"managed","type":"aws_api_gateway_integration","name":"root_integration","provider_config_key":"apigw_test_1:aws","expressions":{"http_method":{"references":["aws_api_gateway_method.root_method"]},"passthrough_behavior":{"constant_value":"WHEN_NO_TEMPLATES"},"request_templates":{"constant_value":{"application/json":"{\"statusCode\": 200}\n"}},"resource_id":{"references":["aws_api_gateway_rest_api.base"]},"rest_api_id":{"references":["aws_api_gateway_rest_api.base"]},"type":{"constant_value":"MOCK"}},"schema_version":0},{"address":"aws_api_gateway_integration_response.root_integration_response","mode":"managed","type":"aws_api_gateway_integration_response","name":"root_integration_response","provider_config_key":"apigw_test_1:aws","expressions":{"http_method":{"references":["aws_api_gateway_method.root_method"]},"resource_id":{"references":["aws_api_gateway_rest_api.base"]},"response_templates":{"constant_value":{"application/json":"{\"ok\": true}"}},"rest_api_id":{"references":["aws_api_gateway_rest_api.base"]},"status_code":{"references":["aws_api_gateway_method_response.root_response"]}},"schema_version":0,"depends_on":["aws_api_gateway_integration.root_integration"]},{"address":"aws_api_gateway_method.root_method","mode":"managed","type":"aws_api_gateway_method","name":"root_method","provider_config_key":"apigw_test_1:aws","expressions":{"authorization":{"constant_value":"NONE"},"http_method":{"constant_value":"ANY"},"resource_id":{"references":["aws_api_gateway_rest_api.base"]},"rest_api_id":{"references":["aws_api_gateway_rest_api.base"]}},"schema_version":0},{"address":"aws_api_gateway_method_response.root_response","mode":"managed","type":"aws_api_gateway_method_response","name":"root_response","provider_config_key":"apigw_test_1:aws","expressions":{"http_method":{"references":["aws_api_gateway_method.root_method"]},"resource_id":{"references":["aws_api_gateway_rest_api.base"]},"response_models":{"constant_value":{"application/json":"Empty"}},"rest_api_id":{"references":["aws_api_gateway_rest_api.base"]},"status_code":{"constant_value":200}},"schema_version":0},{"address":"aws_api_gateway_method_settings.main","mode":"managed","type":"aws_api_gateway_method_settings","name":"main","provider_config_key":"apigw_test_1:aws","expressions":{"method_path":{"constant_value":"*/*"},"rest_api_id":{"references":["aws_api_gateway_rest_api.base"]},"settings":[{"data_trace_enabled":{"constant_value":false},"logging_level":{"constant_value":"INFO"},"metrics_enabled":{"constant_value":true}}],"stage_name":{"references":["aws_api_gateway_stage.main"]}},"schema_version":0,"depends_on":["aws_api_gateway_account.main"]},{"address":"aws_api_gateway_rest_api.base","mode":"managed","type":"aws_api_gateway_rest_api","name":"base","provider_config_key":"apigw_test_1:aws","expressions":{"endpoint_configuration":[{"types":{"references":["var.endpoint_type"]}}],"name":{"references":["var.product","var.api_name"]}},"schema_version":0},{"address":"aws_api_gateway_stage.main","mode":"managed","type":"aws_api_gateway_stage","name":"main","provider_config_key":"apigw_test_1:aws","expressions":{"access_log_settings":[{"destination_arn":{"references":["data.aws_ssm_parameter.stream_arn"]},"format":{"constant_value":"$context.accountId,$context.identity.sourceIp,$context.identity.caller,$context.identity.user,$context.requestTime,$context.httpMethod,$context.resourcePath,$context.protocol,$context.status,$context.responseLength,$context.requestId"}}],"cache_cluster_enabled":{"references":["var.cache_enabled"]},"cache_cluster_size":{"references":["var.cache_size"]},"deployment_id":{"references":["aws_api_gateway_deployment.main"]},"rest_api_id":{"references":["aws_api_gateway_rest_api.base"]},"stage_name":{"references":["var.main_stage_name"]},"xray_tracing_enabled":{"references":["var.xray_tracing_enabled"]}},"schema_version":0},{"address":"aws_route53_record.apigw","mode":"managed","type":"aws_route53_record","name":"apigw","provider_config_key":"apigw_test_1:aws","expressions":{"alias":[{"evaluate_target_health":{"constant_value":true},"name":{"references":["var.endpoint_type","aws_api_gateway_domain_name.apigw","aws_api_gateway_domain_name.apigw"]},"zone_id":{"references":["var.endpoint_type","aws_api_gateway_domain_name.apigw","aws_api_gateway_domain_name.apigw"]}}],"name":{"references":["aws_api_gateway_domain_name.apigw"]},"type":{"constant_value":"A"},"zone_id":{"references":["data.aws_route53_zone.main"]}},"schema_version":2},{"address":"aws_ssm_parameter.api_gw_arn","mode":"managed","type":"aws_ssm_parameter","name":"api_gw_arn","provider_config_key":"apigw_test_1:aws","expressions":{"name":{"references":["var.product","var.api_name"]},"type":{"constant_value":"String"},"value":{"references":["aws_api_gateway_rest_api.base"]}},"schema_version":0},{"address":"aws_ssm_parameter.api_gw_id","mode":"managed","type":"aws_ssm_parameter","name":"api_gw_id","provider_config_key":"apigw_test_1:aws","expressions":{"name":{"references":["var.product","var.api_name"]},"type":{"constant_value":"String"},"value":{"references":["aws_api_gateway_rest_api.base"]}},"schema_version":0},{"address":"aws_ssm_parameter.api_gw_name","mode":"managed","type":"aws_ssm_parameter","name":"api_gw_name","provider_config_key":"apigw_test_1:aws","expressions":{"name":{"references":["var.product","var.api_name"]},"type":{"constant_value":"String"},"value":{"references":["aws_api_gateway_rest_api.base"]}},"schema_version":0},{"address":"aws_ssm_parameter.api_gw_root_resource_id","mode":"managed","type":"aws_ssm_parameter","name":"api_gw_root_resource_id","provider_config_key":"apigw_test_1:aws","expressions":{"name":{"references":["var.product","var.api_name"]},"type":{"constant_value":"String"},"value":{"references":["aws_api_gateway_rest_api.base"]}},"schema_version":0},{"address":"aws_wafv2_web_acl_association.main","mode":"managed","type":"aws_wafv2_web_acl_association","name":"main","provider_config_key":"apigw_test_1:aws","expressions":{"resource_arn":{"references":["aws_api_gateway_stage.main"]},"web_acl_arn":{"references":["var.waf_arn"]}},"schema_version":0},{"address":"data.aws_iam_policy_document.api_gw_logs","mode":"data","type":"aws_iam_policy_document","name":"api_gw_logs","provider_config_key":"apigw_test_1:aws","expressions":{"statement":[{"actions":{"constant_value":["logs:CreateLogGroup","logs:CreateLogStream","logs:DescribeLogGroups","logs:DescribeLogStreams","logs:PutLogEvents","logs:GetLogEvents","logs:FilterLogEvents"]},"resources":{"constant_value":["*"]}}]},"schema_version":0},{"address":"data.aws_region.current","mode":"data","type":"aws_region","name":"current","provider_config_key":"apigw_test_1:aws","schema_version":0},{"address":"data.aws_route53_zone.main","mode":"data","type":"aws_route53_zone","name":"main","provider_config_key":"apigw_test_1:aws","expressions":{"name":{"references":["var.domain_hosted_zone"]},"private_zone":{"constant_value":false}},"schema_version":0},{"address":"data.aws_ssm_parameter.stream_arn","mode":"data","type":"aws_ssm_parameter","name":"stream_arn","provider_config_key":"apigw_test_1:aws","expressions":{"name":{"constant_value":"/cc/account/logging/delivery_streams/apigateway/arn"}},"schema_version":0}],"module_calls":{"acm_cert_edge":{"source":"../aws-acm","expressions":{"product":{"references":["var.product"]},"service":{"references":["var.api_name"]},"zone_domain_name":{"references":["data.aws_route53_zone.main"]}},"count_expression":{"references":["var.endpoint_type"]},"module":{"outputs":{"cert":{"sensitive":true,"expression":{"references":["aws_acm_certificate.cert"]}}},"resources":[{"address":"aws_acm_certificate.cert","mode":"managed","type":"aws_acm_certificate","name":"cert","provider_config_key":"acm_cert_edge:aws","expressions":{"domain_name":{"references":["var.service","var.zone_domain_name"]},"subject_alternative_names":{"references":["var.alternate_fqdns"]},"tags":{"references":["module.common.tags"]},"validation_method":{"constant_value":"DNS"}},"schema_version":0},{"address":"aws_acm_certificate_validation.cert_validation","mode":"managed","type":"aws_acm_certificate_validation","name":"cert_validation","provider_config_key":"acm_cert_edge:aws","expressions":{"certificate_arn":{"references":["aws_acm_certificate.cert"]},"validation_record_fqdns":{"references":["aws_route53_record.cert_validation"]}},"schema_version":0},{"address":"aws_route53_record.cert_validation","mode":"managed","type":"aws_route53_record","name":"cert_validation","provider_config_key":"acm_cert_edge:aws","expressions":{"allow_overwrite":{"constant_value":true},"name":{"references":["each.value"]},"records":{"references":["each.value"]},"ttl":{"constant_value":60},"type":{"references":["each.value"]},"zone_id":{"references":["data.aws_route53_zone.external"]}},"schema_version":2,"for_each_expression":{"references":["aws_acm_certificate.cert"]}},{"address":"data.aws_route53_zone.external","mode":"data","type":"aws_route53_zone","name":"external","provider_config_key":"acm_cert_edge:aws","expressions":{"name":{"references":["var.zone_domain_name"]},"private_zone":{"constant_value":false}},"schema_version":0}],"module_calls":{"common":{"source":"../aws-common","expressions":{"product":{"references":["var.product"]}},"module":{"outputs":{"account_id":{"expression":{"references":["data.aws_caller_identity.current"]}},"account_ids":{"expression":{"references":["local.account_ids"]}},"cc_pb_arn":{"expression":{"references":["data.aws_caller_identity.current"]}},"ip_ranges":{"expression":{"references":["local.ip_ranges"]}},"name_prefix":{"expression":{"references":["local.name_prefix"]}},"product_pb_arn":{"expression":{"references":["data.aws_caller_identity.current"]}},"tags":{"expression":{"references":["local.tags"]}}},"resources":[{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_config_key":"common:aws","schema_version":0}],"variables":{"product":{"description":"The product using this module"}}}}},"variables":{"alternate_fqdns":{"default":[],"description":"List of alternate domain names to be included with the certificate."},"product":{"description":"The name of the product utilising this module"},"service":{"description":"The name of the service for which to provision a certificate. e.g. service.product.aws.cmclabs.io."},"zone_domain_name":{"description":"The domain name to use to validate the certificate."}}}},"acm_cert_regional":{"source":"../aws-acm","expressions":{"product":{"references":["var.product"]},"service":{"references":["var.api_name"]},"zone_domain_name":{"references":["data.aws_route53_zone.main"]}},"count_expression":{"references":["var.endpoint_type"]},"module":{"outputs":{"cert":{"sensitive":true,"expression":{"references":["aws_acm_certificate.cert"]}}},"resources":[{"address":"aws_acm_certificate.cert","mode":"managed","type":"aws_acm_certificate","name":"cert","provider_config_key":"acm_cert_regional:aws","expressions":{"domain_name":{"references":["var.service","var.zone_domain_name"]},"subject_alternative_names":{"references":["var.alternate_fqdns"]},"tags":{"references":["module.common.tags"]},"validation_method":{"constant_value":"DNS"}},"schema_version":0},{"address":"aws_acm_certificate_validation.cert_validation","mode":"managed","type":"aws_acm_certificate_validation","name":"cert_validation","provider_config_key":"acm_cert_regional:aws","expressions":{"certificate_arn":{"references":["aws_acm_certificate.cert"]},"validation_record_fqdns":{"references":["aws_route53_record.cert_validation"]}},"schema_version":0},{"address":"aws_route53_record.cert_validation","mode":"managed","type":"aws_route53_record","name":"cert_validation","provider_config_key":"acm_cert_regional:aws","expressions":{"allow_overwrite":{"constant_value":true},"name":{"references":["each.value"]},"records":{"references":["each.value"]},"ttl":{"constant_value":60},"type":{"references":["each.value"]},"zone_id":{"references":["data.aws_route53_zone.external"]}},"schema_version":2,"for_each_expression":{"references":["aws_acm_certificate.cert"]}},{"address":"data.aws_route53_zone.external","mode":"data","type":"aws_route53_zone","name":"external","provider_config_key":"acm_cert_regional:aws","expressions":{"name":{"references":["var.zone_domain_name"]},"private_zone":{"constant_value":false}},"schema_version":0}],"module_calls":{"common":{"source":"../aws-common","expressions":{"product":{"references":["var.product"]}},"module":{"outputs":{"account_id":{"expression":{"references":["data.aws_caller_identity.current"]}},"account_ids":{"expression":{"references":["local.account_ids"]}},"cc_pb_arn":{"expression":{"references":["data.aws_caller_identity.current"]}},"ip_ranges":{"expression":{"references":["local.ip_ranges"]}},"name_prefix":{"expression":{"references":["local.name_prefix"]}},"product_pb_arn":{"expression":{"references":["data.aws_caller_identity.current"]}},"tags":{"expression":{"references":["local.tags"]}}},"resources":[{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_config_key":"common:aws","schema_version":0}],"variables":{"product":{"description":"The product using this module"}}}}},"variables":{"alternate_fqdns":{"default":[],"description":"List of alternate domain names to be included with the certificate."},"product":{"description":"The name of the product utilising this module"},"service":{"description":"The name of the service for which to provision a certificate. e.g. service.product.aws.cmclabs.io."},"zone_domain_name":{"description":"The domain name to use to validate the certificate."}}}},"api_gw_log_role":{"source":"../aws-iam-role","expressions":{"permissions_boundary":{"references":["var.permissions_boundary"]},"policy_document":{"references":["data.aws_iam_policy_document.api_gw_logs"]},"product":{"references":["var.product"]},"role_name":{"references":["var.api_name","data.aws_region.current"]},"service_principals":{"constant_value":["apigateway.amazonaws.com"]}},"module":{"outputs":{"role":{"expression":{"references":["aws_iam_role.default"]},"description":"The created role object"}},"resources":[{"address":"aws_iam_policy.default","mode":"managed","type":"aws_iam_policy","name":"default","provider_config_key":"api_gw_log_role:aws","expressions":{"name":{"references":["local.policy_name"]},"policy":{"references":["var.policy_document"]}},"schema_version":0,"count_expression":{"references":["var.policy_document"]}},{"address":"aws_iam_role.default","mode":"managed","type":"aws_iam_role","name":"default","provider_config_key":"api_gw_log_role:aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.assume_role_policy"]},"name":{"references":["local.role_name"]},"permissions_boundary":{"references":["var.permissions_boundary","var.permissions_boundary"]},"tags":{"references":["module.common.tags"]}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.inline","mode":"managed","type":"aws_iam_role_policy_attachment","name":"inline","provider_config_key":"api_gw_log_role:aws","expressions":{"policy_arn":{"references":["aws_iam_policy.default","count.index"]},"role":{"references":["aws_iam_role.default"]}},"schema_version":0,"count_expression":{"references":["var.policy_document"]}},{"address":"aws_iam_role_policy_attachment.managed","mode":"managed","type":"aws_iam_role_policy_attachment","name":"managed","provider_config_key":"api_gw_log_role:aws","expressions":{"policy_arn":{"references":["var.managed_policies","count.index"]},"role":{"references":["aws_iam_role.default"]}},"schema_version":0,"count_expression":{"references":["var.managed_policies"]}},{"address":"data.aws_iam_policy_document.assume_role_policy","mode":"data","type":"aws_iam_policy_document","name":"assume_role_policy","provider_config_key":"api_gw_log_role:aws","schema_version":0}],"module_calls":{"common":{"source":"../aws-common","expressions":{"product":{"references":["var.product"]}},"module":{"outputs":{"account_id":{"expression":{"references":["data.aws_caller_identity.current"]}},"account_ids":{"expression":{"references":["local.account_ids"]}},"cc_pb_arn":{"expression":{"references":["data.aws_caller_identity.current"]}},"ip_ranges":{"expression":{"references":["local.ip_ranges"]}},"name_prefix":{"expression":{"references":["local.name_prefix"]}},"product_pb_arn":{"expression":{"references":["data.aws_caller_identity.current"]}},"tags":{"expression":{"references":["local.tags"]}}},"resources":[{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_config_key":"common:aws","schema_version":0}],"variables":{"product":{"description":"The product using this module"}}}}},"variables":{"aws_principals":{"default":[],"description":"A list of AWS principals who can assume this role"},"managed_policies":{"default":[],"description":"A list of AWS managed policies to attach to this role"},"permissions_boundary":{"default":"","description":"The ARN of a permissions boundary to attach to this role"},"policy_document":{"default":false,"description":"The JSON IAM policy document for this role"},"product":{"description":"The name of the product utilising this module"},"role_name":{"description":"The name of the IAM role to create, will be prepended by product name"},"service_principals":{"default":[],"description":"A list of service principals who can assume this role"}}}}},"variables":{"api_name":{"description":"The name of the API."},"cache_enabled":{"default":false,"description":"Whether caching is enabled for this API Stage"},"cache_size":{"default":"0.5","description":"Size of the cache cluster for this API. Must be one of 0.5, 1.6, 6.1, 13.5, 28.4, 58.2, 118 or 237"},"domain_hosted_zone":{"description":"The root domain hosted zone name."},"endpoint_type":{"description":"The API endpoint type. Must be one of EDGE, PRIVATE or REGIONAL"},"main_stage_name":{"default":"main","description":"Name of the default stage."},"permissions_boundary":{"description":"The IAM Permissions boundary that applies here. Can be retrieved from the common module."},"product":{"description":"The product name (e.g. alpha, kipling)"},"waf_arn":{"description":"The ARN of the WAF ruleset to associate with the API Gateway stage"},"xray_tracing_enabled":{"default":false,"description":"Whether active tracing with X-ray is enabled."}}}}}}}}
